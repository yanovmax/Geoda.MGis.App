"use strict";(self.webpackChunkmgis_app=self.webpackChunkmgis_app||[]).push([[9623],{89623:function(e,t,r){r.d(t,{Z:function(){return R}});var n=r(37762),u=r(29439),a=r(74165),o=r(15861),i=r(15671),s=r(43144),c=r(60136),l=r(29388),p=r(27366),f=r(7138),d=r(10064),h=r(93169),y=r(66978),m=r(35995),v=r(49861),b=(r(25243),r(63780),r(69912)),x=r(18277),Z=r(64020),S=r(23084),k=r(34211),F=r(1413),D=(r(59486),r(5192)),g=r(86638),w=r(53866);function O(){return O=(0,o.Z)((0,a.Z)().mark((function e(t,r,n){var u;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=(0,S.en)(t),e.abrupt("return",(0,D.Vr)(u,g.Z.from(r),(0,F.Z)({},n)).then((function(e){return{count:e.data.count,extent:w.Z.fromJSON(e.data.extent)}})));case 2:case"end":return e.stop()}}),e)}))),O.apply(this,arguments)}var _=r(24246),C=r(77946),Q=r(90851),V=r(49818),j=function(e){(0,c.Z)(p,e);var t=(0,l.Z)(p);function p(e){var r;return(0,i.Z)(this,p),(r=t.call(this,e)).dynamicDataSource=null,r.fieldsIndex=null,r.gdbVersion=null,r.infoFor3D=null,r.pbfSupported=!1,r.queryAttachmentsSupported=!1,r.sourceSpatialReference=null,r.url=null,r}return(0,s.Z)(p,[{key:"parsedUrl",get:function(){return(0,m.mN)(this.url)}},{key:"execute",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,r){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.executeJSON(t,r);case 2:return n=e.sent,e.abrupt("return",this.featureSetFromJSON(t,n,r));case 4:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"executeJSON",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,r){var n,u,o,i,s,c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=this._normalizeQuery(t),o=null!=(null===(n=t.outStatistics)||void 0===n?void 0:n[0]),i=(0,h.Z)("featurelayer-pbf-statistics"),s=!o||i,!this.pbfSupported||!s){e.next=13;break}return e.prev=2,e.next=5,(0,Q.t)(this.url,u,r);case 5:c=e.sent,e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(2),"query:parsing-pbf"===e.t0.name){e.next=12;break}throw e.t0;case 12:this.pbfSupported=!1;case 13:if(e.t1=this.pbfSupported&&s,e.t1){e.next=18;break}return e.next=17,(0,C.F)(this.url,u,r);case 17:c=e.sent;case 18:return this._normalizeFields(c.fields),e.abrupt("return",c);case 20:case"end":return e.stop()}}),e,this,[[2,8]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"featureSetFromJSON",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n,u){var o,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._queryIs3DObjectFormat(t)&&null!=this.infoFor3D&&n.features){e.next=2;break}return e.abrupt("return",V.Z.fromJSON(n));case 2:return e.next=4,(0,y.Hl)(Promise.all([r.e(5158),r.e(7898),r.e(1495)]).then(r.bind(r,65169)),u);case 4:return o=e.sent,i=o.meshFeatureSetFromJSON,e.abrupt("return",i(t,this.infoFor3D,n));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"executeForCount",value:function(e,t){return(0,k.P)(this.url,this._normalizeQuery(e),t)}},{key:"executeForExtent",value:function(e,t){return function(e,t,r){return O.apply(this,arguments)}(this.url,this._normalizeQuery(e),t)}},{key:"executeForIds",value:function(e,t){return(0,_.G)(this.url,this._normalizeQuery(e),t)}},{key:"executeRelationshipQuery",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n){var o,i,s,c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,y.Hl)(Promise.all([Promise.resolve().then(r.bind(r,99086)),r.e(2964).then(r.bind(r,12964))]),n);case 2:return o=e.sent,i=(0,u.Z)(o,2),s=i[0].default,c=i[1].executeRelationshipQuery,e.abrupt("return",(t=s.from(t),(this.gdbVersion||this.dynamicDataSource)&&((t=t.clone()).gdbVersion=t.gdbVersion||this.gdbVersion,t.dynamicDataSource=t.dynamicDataSource||this.dynamicDataSource),c(this.url,t,n)));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"executeRelationshipQueryForCount",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n){var o,i,s,c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,y.Hl)(Promise.all([Promise.resolve().then(r.bind(r,99086)),r.e(2964).then(r.bind(r,12964))]),n);case 2:return o=e.sent,i=(0,u.Z)(o,2),s=i[0].default,c=i[1].executeRelationshipQueryForCount,e.abrupt("return",(t=s.from(t),(this.gdbVersion||this.dynamicDataSource)&&((t=t.clone()).gdbVersion=t.gdbVersion||this.gdbVersion,t.dynamicDataSource=t.dynamicDataSource||this.dynamicDataSource),c(this.url,t,n)));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"executeAttachmentQuery",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n){var u,o,i,s,c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,y.Hl)(r.e(9301).then(r.bind(r,59301)),n);case 2:return u=e.sent,o=u.executeAttachmentQuery,i=u.fetchAttachments,s=u.processAttachmentQueryResult,c=(0,S.en)(this.url),e.t0=s,e.t1=c,e.next=11,this.queryAttachmentsSupported?o(c,t,n):i(c,t,n);case 11:return e.t2=e.sent,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 13:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"executeTopFeaturesQuery",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n){var u,o;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,y.Hl)(r.e(2200).then(r.bind(r,82200)),n);case 2:return u=e.sent,o=u.executeTopFeaturesQuery,e.abrupt("return",o(this.parsedUrl,t,this.sourceSpatialReference,n));case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"executeForTopIds",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n){var u,o;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,y.Hl)(r.e(5182).then(r.bind(r,75182)),n);case 2:return u=e.sent,o=u.executeForTopIds,e.abrupt("return",o(this.parsedUrl,t,n));case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"executeForTopExtents",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n){var u,o;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,y.Hl)(r.e(5641).then(r.bind(r,55641)),n);case 2:return u=e.sent,o=u.executeForTopExtents,e.abrupt("return",o(this.parsedUrl,t,n));case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"executeForTopCount",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n){var u,o;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,y.Hl)(r.e(9406).then(r.bind(r,19406)),n);case 2:return u=e.sent,o=u.executeForTopCount,e.abrupt("return",o(this.parsedUrl,t,n));case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_normalizeQuery",value:function(e){var t=g.Z.from(e);t.sourceSpatialReference=t.sourceSpatialReference||this.sourceSpatialReference,(this.gdbVersion||this.dynamicDataSource)&&((t=t===e?t.clone():t).gdbVersion=e.gdbVersion||this.gdbVersion,t.dynamicDataSource=e.dynamicDataSource?Z.n.from(e.dynamicDataSource):this.dynamicDataSource);var r=this.infoFor3D;if(null!=r&&this._queryIs3DObjectFormat(e)){var u,a;(t=t===e?t.clone():t).formatOf3DObjects=null;var o,i=r.supportedFormats,s=r.queryFormats,c=null!==(u=(0,x.S0)("model/gltf-binary",i))&&void 0!==u?u:(0,x.Ow)("glb",i),l=null!==(a=(0,x.S0)("model/gltf+json",i))&&void 0!==a?a:(0,x.Ow)("gtlf",i),p=(0,n.Z)(s);try{for(p.s();!(o=p.n()).done;){var f=o.value;if(f===c){t.formatOf3DObjects=f;break}f!==l||t.formatOf3DObjects||(t.formatOf3DObjects=f)}}catch(V){p.e(V)}finally{p.f()}if(!t.formatOf3DObjects)throw new d.Z("query:unsupported-3d-query-formats","Could not find any supported 3D object query format. Only supported formats are 3D_glb and 3D_gltf");if(null==t.outFields||!t.outFields.includes("*")){null==(t=t===e?t.clone():t).outFields&&(t.outFields=[]);var h=r.transformFieldRoles,y=h.originX,m=h.originY,v=h.originZ,b=h.translationX,S=h.translationY,k=h.translationZ,F=h.scaleX,D=h.scaleY,w=h.scaleZ,O=h.rotationX,_=h.rotationY,C=h.rotationZ,Q=h.rotationDeg;t.outFields.push(y,m,v,b,S,k,F,D,w,O,_,C,Q)}}return t}},{key:"_normalizeFields",value:function(e){if(null!=this.fieldsIndex&&null!=e){var t,r=(0,n.Z)(e);try{for(r.s();!(t=r.n()).done;){var u=t.value,a=this.fieldsIndex.get(u.name);a&&Object.assign(u,a.toJSON())}}catch(o){r.e(o)}finally{r.f()}}}},{key:"_queryIs3DObjectFormat",value:function(e){return null!=this.infoFor3D&&!0===e.returnGeometry&&"xyFootprint"!==e.multipatchOption&&!e.outStatistics}}]),p}(f.Z);(0,p._)([(0,v.Cb)({type:Z.n})],j.prototype,"dynamicDataSource",void 0),(0,p._)([(0,v.Cb)()],j.prototype,"fieldsIndex",void 0),(0,p._)([(0,v.Cb)()],j.prototype,"gdbVersion",void 0),(0,p._)([(0,v.Cb)()],j.prototype,"infoFor3D",void 0),(0,p._)([(0,v.Cb)({readOnly:!0})],j.prototype,"parsedUrl",null),(0,p._)([(0,v.Cb)()],j.prototype,"pbfSupported",void 0),(0,p._)([(0,v.Cb)()],j.prototype,"queryAttachmentsSupported",void 0),(0,p._)([(0,v.Cb)()],j.prototype,"sourceSpatialReference",void 0),(0,p._)([(0,v.Cb)({type:String})],j.prototype,"url",void 0);var R=j=(0,p._)([(0,b.j)("esri.tasks.QueryTask")],j)}}]);
//# sourceMappingURL=9623.8194d369.chunk.js.map